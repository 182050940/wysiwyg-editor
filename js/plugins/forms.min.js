/*!
 * froala_editor v2.2.1 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2016 Froala Labs
 */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c),c}:a(jQuery)}(function(a){"use strict";a.extend(a.FE.POPUP_TEMPLATES,{"forms.editInput":"[_PLACEHOLDER_LAYER_]","forms.editButton":"[_BUTTONS_]","forms.updateButton":"[_BUTTONS_][_BTN_LAYER_]"}),a.extend(a.FE.DEFAULTS,{buttonEditButtons:["buttonStyle","buttonEdit"],buttonStyles:{"fr-rounded":"Rounded","fr-large":"Large"},buttonMultipleStyles:!0,buttonUpdateButtons:["buttonBack"]}),a.FE.PLUGINS.forms=function(b){function c(b){"BUTTON"!=this.tagName&&b.preventDefault(),a(this).data("mousedown",!0)}function d(){var a=b.popups.get("forms.editInput");z?a.find('input[type="text"][name="placeholder"]').val(z.attr("placeholder")):a.find('input[type="text"][name="placeholder"]').val(""),a.find('input[type="text"][name="placeholder"]').trigger("change")}function e(){var a=b.popups.get("forms.editInput");z&&(z.attr("placeholder",a.find('input[type="text"][name="placeholder"]').val()),b.popups.hide("forms.editInput"))}function f(){z=null}function g(a){if(a)return b.popups.onRefresh("forms.editInput",d),b.popups.onHide("forms.editInput",f),!0;var c=0,e='<div class="fr-layer fr-input-placeholder-layer fr-active">';e+='<div class="fr-input-line"><input name="placeholder" type="text" placeholder="Placeholder Text" tabIndex="'+ ++c+'"></div>',e+='<div class="fr-action-buttons"><button class="fr-command fr-submit" data-cmd="updateInput" href="#" tabIndex="'+ ++c+'" type="button">'+b.language.translate("Update")+"</button></div>",e+="</div>";var g={placeholder_layer:e},h=b.popups.create("forms.editInput",g);return h}function h(){var c=b.popups.get("forms.editInput");c||(c=g()),b.popups.setContainer("forms.editInput",a(b.opts.scrollableContainer)),b.popups.refresh("forms.editInput");var d=z.offset().left+z.outerWidth()/2,e=z.offset().top+z.outerHeight();b.popups.show("forms.editInput",d,e,z.outerHeight())}function i(b){a(this).data("mousedown")&&(b.stopPropagation(),a(this).removeData("mousedown"),z=a(this),"BUTTON"!=this.tagName?h():q(this)),b.preventDefault()}function j(){return z}function k(){b.$el.find("input, textarea, button").removeData("mousedown")}function l(){a(this).removeData("mousedown")}function m(){b.events.$on(b.$el,b._mousedown,"input, textarea, button",c),b.events.$on(b.$el,b._mouseup,"input, textarea, button",i),b.events.$on(b.$el,"touchmove","input, textarea, button",l),b.events.$on(b.$el,b._mouseup,k),b.events.$on(b.$win,b._mouseup,k),g(!0),t(!0)}function n(){if(b.$wp){var c=b.selection.element(),d=b.selection.endElement();return"BUTTON"!=c.tagName&&(c=a(c).parents("button:first").get(0)),"BUTTON"!=d.tagName&&(d=a(d).parents("button:first").get(0)),d&&d==c?c:null}return"BUTTON"==b.$el.get(0).tagName&&b.core.hasFocus()?b.$el:null}function o(){var a="";b.opts.buttonEditButtons.length>0&&(a='<div class="fr-buttons">'+b.button.buildList(b.opts.buttonEditButtons)+"</div>");var c={buttons:a},d=b.popups.create("forms.editButton",c);return b.$wp&&b.events.$on(b.$wp,"scroll.link-edit",function(){get()&&b.popups.isVisible("forms.editButton")&&_showEditPopup(get())}),d}function p(c){var d=b.popups.get("forms.editButton");d||(d=o());var e=a(c);e.prepend(a.FE.START_MARKER).append(a.FE.END_MARKER),b.selection.restore(),b.popups.isVisible("forms.editButton")||b.popups.refresh("forms.editButton"),b.popups.setContainer("forms.editButton",a(b.opts.scrollableContainer));var f=e.offset().left+e.outerWidth()/2,g=e.offset().top+e.outerHeight();b.popups.show("forms.editButton",f,g,e.outerHeight())}function q(a){b.popups.hide("forms.editButton"),a||(a=n()),a&&p(a)}function r(){var a=b.popups.get("forms.updateButton");A?a.find('input[type="text"][name="text"]').val(A.text()):a.find('input[type="text"][name="text"]').val(""),a.find('input[type="text"][name="text"]').trigger("change")}function s(){A=null}function t(a){if(a)return b.popups.onRefresh("forms.updateButton",r),b.popups.onHide("forms.updateButton",s),!0;var c="";b.opts.buttonUpdateButtons.length>=1&&(c='<div class="fr-buttons">'+b.button.buildList(b.opts.buttonUpdateButtons)+"</div>");var d="",e=0;d='<div class="fr-btn-update-layer fr-layer fr-active">',d+='<div class="fr-input-line"><input name="text" type="text" placeholder="Text" tabIndex="'+ ++e+'"></div>',d+='<div class="fr-action-buttons"><button class="fr-command fr-submit" data-cmd="updateButton" href="#" tabIndex="'+ ++e+'" type="button">'+b.language.translate("Update")+"</button></div></div>";var f={buttons:c,btn_layer:d},g=b.popups.create("forms.updateButton",f);return g}function u(){b.popups.hide("forms.editButton");var c=n();if(c){A=a(c);var d=b.popups.get("forms.updateButton");d||(d=t()),b.popups.isVisible("forms.updateButton")||(b.popups.refresh("forms.updateButton"),b.selection.save(),b.helpers.isMobile()&&(b.events.disableBlur(),b.$el.blur(),b.events.enableBlur())),b.popups.setContainer("forms.updateButton",a(b.opts.scrollableContainer));var e=A.offset().left+A.outerWidth()/2,f=A.offset().top+A.outerHeight();b.popups.show("forms.updateButton",e,f,A.outerHeight())}}function v(c){var d=n();if(!d)return!1;if(!b.opts.buttonMultipleStyles){var e=Object.keys(b.opts.buttonMultipleStyles);e.splice(e.indexOf(c),1),a(link).removeClass(e.join(" "))}a(d).toggleClass(c)}function w(){b.events.disableBlur(),b.selection.restore(),b.events.enableBlur();var a=n();a&&b.$wp&&(b.selection.restore(),q())}function x(){var c=b.popups.get("forms.updateButton");A&&(A.text(c.find('input[type="text"][name="text"]').val()),A.prepend(a.FE.START_MARKER).append(a.FE.END_MARKER),b.selection.restore(),b.popups.hide("forms.updateButton"),q())}function y(){m(),b.events.$on(b.$el,"submit","form",function(a){return a.preventDefault(),!1})}var z,A;return{_init:y,updateInput:e,getInput:j,getButton:n,applyButtonStyle:v,showButtonUpdatePopup:u,buttonBack:w,updateButton:x}},a.FE.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}}),a.FE.DefineIcon("buttonStyle",{NAME:"magic"}),a.FE.RegisterCommand("buttonStyle",{title:"Style",type:"dropdown",html:function(){var a='<ul class="fr-dropdown-list">',b=this.opts.buttonStyles;for(var c in b)a+='<li><a class="fr-command" data-cmd="buttonStyle" data-param1="'+c+'">'+this.language.translate(b[c])+"</a></li>";return a+="</ul>"},callback:function(a,b){this.forms.applyButtonStyle(b)},refreshOnShow:function(b,c){var d=this.forms.getButton();if(d){var e=a(d);c.find(".fr-command").each(function(){var b=a(this).data("param1");a(this).toggleClass("fr-active",e.hasClass(b))})}}}),a.FE.DefineIcon("buttonEdit",{NAME:"edit"}),a.FE.RegisterCommand("buttonEdit",{title:"Edit Button",undo:!1,refreshAfterCallback:!1,callback:function(){this.forms.showButtonUpdatePopup()}}),a.FE.DefineIcon("buttonBack",{NAME:"arrow-left"}),a.FE.RegisterCommand("buttonBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.forms.buttonBack()}}),a.FE.RegisterCommand("updateButton",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateButton()}})});